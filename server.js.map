{"mappings":"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","sources":["public/js/index.js","public/js/mapbox.js","public/js/login.js","public/js/alerts.js","public/js/updateSettings.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\nimport '@babel/polyfill';\nimport { displayMap } from './mapbox';\nimport { login, logout } from './login';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe';\nimport { showAlert } from './alerts';\n\n// DOM ELEMENTS\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookBtn = document.getElementById('book-tour');\n\n// DELEGATION\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm) {\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    login(email, password);\n  });\n}\n\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\n\nif (userDataForm)\n  userDataForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const name = document.getElementById('name').value;\n    const email = document.getElementById('email').value;\n    const photo = document.getElementById('photo').files[0];\n    updateSettings({ name, email, photo }, 'data');\n  });\n\nif (userPasswordForm)\n  userPasswordForm.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await updateSettings(\n      { passwordCurrent, password, passwordConfirm },\n      'password',\n    );\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n\nif (bookBtn)\n  bookBtn.addEventListener('click', (e) => {\n    e.target.textContent = 'Processing...';\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n\nconst alertMessage = document.querySelector('body').dataset.alert;\nif (alertMessage) showAlert('success', alertMessage, 20);\n","// /* eslint-disable */\n\n// console.log('hello from js mapbox');\n\n// export const displayMap = locations => {\n//   mapboxgl.accessToken =\n//     'pk.eyJ1Ijoiam9uYXNzY2htZWR0bWFubiIsImEiOiJjam54ZmM5N3gwNjAzM3dtZDNxYTVlMnd2In0.ytpI7V7w7cyT1Kq5rT9Z1A';\n\n//   var map = new mapboxgl.Map({\n//     container: 'map',\n//     style: 'mapbox://styles/jonasschmedtmann/cjvi9q8jd04mi1cpgmg7ev3dy',\n//     scrollZoom: false\n//     // center: [-118.113491, 34.111745],\n//     // zoom: 10,\n//     // interactive: false\n//   });\n\n//   const bounds = new mapboxgl.LngLatBounds();\n\n//   locations.forEach(loc => {\n//     // Create marker\n//     const el = document.createElement('div');\n//     el.className = 'marker';\n\n//     // Add marker\n//     new mapboxgl.Marker({\n//       element: el,\n//       anchor: 'bottom'\n//     })\n//       .setLngLat(loc.coordinates)\n//       .addTo(map);\n\n//     // Add popup\n//     new mapboxgl.Popup({\n//       offset: 30\n//     })\n//       .setLngLat(loc.coordinates)\n//       .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\n//       .addTo(map);\n\n//     // Extend map bounds to include current location\n//     bounds.extend(loc.coordinates);\n//   });\n\n//   map.fitBounds(bounds, {\n//     padding: {\n//       top: 200,\n//       bottom: 150,\n//       left: 100,\n//       right: 100\n//     }\n//   });\n// };\n","/* eslint-disable */\nimport axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const login = async (email, password) => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/v1/users/login',\n      data: {\n        email,\n        password,\n      },\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Logged in successfully!');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1500);\n    }\n    // console.log('res.data', res.data);\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/v1/users/logout',\n    });\n    if (res.data.status === 'success') {\n      location.reload(true); // Reload the page to reflect logout\n    }\n  } catch (err) {\n    // console.log(err);\n    showAlert('error', 'Error logging out! Try again.');\n  }\n};\n","/* eslint-disable */\n\nexport const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is 'success' or 'error'\nexport const showAlert = (type, msg, time = 7) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, time * 1000);\n};\n","/* eslint-disable */\nimport axios from 'axios';\nimport { showAlert } from './alerts';\n\n// type is either 'password' or 'data'\nexport const updateSettings = async (data, type) => {\n  // console.log('updateSettings data', data);\n  try {\n    const url =\n      type === 'password'\n        ? '/api/v1/users/updatePassword'\n        : '/api/v1/users/updateMe';\n\n    const res = await axios({\n      method: 'PATCH',\n      url,\n      data,\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n","/* eslint-disable */\nimport axios from 'axios';\nimport { showAlert } from './alerts';\nconst stripe = Stripe('pk_test_BUkd0ZXAj6m0q0jMyRgBxNns00PPtgvjjr');\n\nexport const bookTour = async (tourId) => {\n  try {\n    // 1) Get checkout session from API\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n    // // console.log(session);\n\n    // 2) Create checkout form + chanre credit card\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n  } catch (err) {\n    // console.log(err);\n    showAlert('error', err);\n  }\n};\n"],"names":[],"version":3,"file":"server.js.map","sourceRoot":"/"}